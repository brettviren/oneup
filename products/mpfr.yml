---
# A playbook to build MPFR

- hosts: all
  vars:
    pkg: mpfr
    srcdir: ${pkg}-${version}
    tarball: ${srcdir}.tar.bz2
    url: http://www.mpfr.org/mpfr-current/${tarball}
    configure_opts: ${products.${pkg}.configure_opts} ${gmp_dep.result}

  tasks:
    
    - local_action: interpolate 
                    pattern="--with-%(pkg)s=$pkg_install_pattern" 
                    pkg=gmp version=${products.gmp.version}
      register: gmp_dep
      tags:
        - configure

    # - local_action: interpolate pattern=$pkg_build_pattern pkg=$pkg version=$version
    #   register: res2


    - debug: msg="configure_opt = ${configure_opts}"
      tags:
        - configure

    - include: $top/tasks/directories.yml

    - include: $top/tasks/download.yml

    - include: $top/tasks/untar.yml tar_opts=-xjf

    - include: $top/tasks/configure.yml 

    - include: $top/tasks/make.yml 



